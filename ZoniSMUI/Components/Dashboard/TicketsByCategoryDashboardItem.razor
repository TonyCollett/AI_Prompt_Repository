@inject ITicketData ticketData

<MudPaper Class="pa-4" Elevation="3">
    <MudStack AlignItems="AlignItems.Center">
        <MudStack Row="true">
            <MudIcon Icon="@Icons.Material.Filled.Assessment" Color="Color.Primary" Size="Size.Large" />
            <MudText Typo="Typo.h6"> Active Tickets By Category </MudText>
        </MudStack>
        <MudChart ChartType="ChartType.Donut" InputData="@data" @bind-SelectedIndex="index" InputLabels="@labels" Width="150px" Height="150px" />
    </MudStack>
</MudPaper>

@code {
    private List<Ticket> ticketList;
    private int index = -1;
    private double[] data;
    private string[] labels;
    
    protected async override Task OnInitializedAsync()
    {
        ticketList = await ticketData.GetAllActiveTicketsAsync();
        
        var ticketsByCategory = ticketList.GroupBy(w => w.Category.Name).Select(w => new { Category = w.Key, Count = w.Count() });
        data = ticketsByCategory.Select(w => (double)w.Count).ToArray();
        labels = ticketsByCategory.Select(w => w.Category).ToArray();
        
    }
}